P=zeros(4,4);

P(1,1)=1/2;
P(1,2)=1/4;
P(1,5)=1/4;
P(2,2)=1/4;
P(2,1)=1/4;
P(2,3)=1/4;
P(2,6)=1/4;
P(3,3)=1/4;
P(3,2)=1/4;
P(3,4)=1/4;
P(3,7)=1/4;
P(4,4)=1/2;
P(4,3)=1/4;
P(4,8)=1/4;

P(5,5)=1/4;
P(5,1)=1/4;
P(5,6)=1/4;
P(5,9)=1/4;

P(6,2)=1/4;
P(6,4)=1/4;
P(6,7)=1/4;
P(6,10)=1/4;
P(7,3)=1/4;
P(7,6)=1/4;
P(7,8)=1/4;
P(7,7)=1/4; % P(7,11)=1/4;

P(8,8)=1/2;
P(8,4)=1/4;
P(8,7)=1/4;
% P(8,12)=1/4;

P(9,5)=1/4;
P(9,10)=1/4;
P(9,13)=1/4;
P(9,9)=1/4;

P(10,9)=1/4;
P(10,6)=1/4;
P(10,11)=1/4;
P(10,14)=1/4;

P(11,10)=1/4;
P(11,12)=1/4;
P(11,11)=1/4; % P(11,7)=1/4;
P(11,15)=1/4;

% P(12,8)=1/4;
P(12,11)=1/4;
P(12,16)=1/4;
P(12,12)=1/2;

P(13,13)=1/2;
P(13,9)=1/4;
P(13,14)=1/4;

P(14,13)=1/4;
P(14,10)=1/4;
P(14,15)=1/4;
P(14,14)=1/4;

P(15,14)=1/4;
P(15,11)=1/4;
P(15,16)=1/4;
P(15,15)=1/4;

P(16,12)=1/4;
P(16,15)=1/4;
P(16,16)=1/2;

r=zeros(16,1);
r(16)=1;

v=zeros(16,1);

figure(1);
imagesc(reshape(r,4,4))
colorbar;
axis off
axis equal

gamma=0.95;

for i=1:20,
  pause;
  disp('press any key');
  fprintf('iteration %g\n',i);
  v=P*(r+gamma*v);
  figure(1);
  imagesc(reshape(v,4,4))
  colorbar;
  axis off
  axis equal
end;









